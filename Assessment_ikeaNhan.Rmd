---
title: "Assessment3"
author: "Chi WAN"
date: "08/11/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(skimr)

ikea <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-11-03/ikea.csv')
```
```{r}
## Price, remove the no old price
ikea<-ikea%>%
  mutate(old_price= parse_number(old_price))
```
## Executive Summary
```{r}
## Product are not sellable online
ikea%>%
  filter(sellable_online=="FALSE")
```

```{r}
## count category
ikea%>%
  count(category,sort = TRUE)
```
```{r}
ikea %>%
  add_count(category) %>%
  mutate(category_fct = fct_reorder(category, n)) %>%
  ggplot(aes(x = category_fct)) +
  geom_bar() +
  geom_text(aes(label = n, y = n), nudge_y = 30)+
  coord_flip() +
  theme_minimal() +
  labs(x = "Items",
       y = "Number",
       title = "Category")

```
```{r}
## create a new variable for discount = Old price - Price
ikea<-ikea%>%
  mutate(discount=100-price/old_price*100)
```
```{r}
ikea%>%
  count(designer, sort = TRUE)
```

```{r}
## How is the price relaed to the furniture dimensions?
ikea%>%
  count(other_colors,sort = TRUE)
```



## Introduction

##Target Audience:
CEO of IKEA

##Purpose of Scope:
The target for this presentation is to increase the sales by reducing the price, increasing the number of sales.

##Strategy:
-To determine the top selling products
-To maximize the sales
-To re-adjust the price if the sales is not hit the target
-To push every single product online
-To maximize the choice of the color

##Finding:
- We realize that the not all of the product are available online, which means 28 products are not for online sale, the stock will be stuck and the inventory cost will be increase.
- To review the price as Ikea already did, we can see that 654 out of 3694 had adjusted the price, use case_by to identify the old_price vs current price
- The percentage of the price after discount = the
- New expected consumption= (discount) *number of products


```{r}
#number of not online sellable items
ikea%>%
  count(sellable_online,sort = FALSE)
```

```{r}
onlyFALSE<-
 ikea%>%
  filter(sellable_online=="FALSE")
```
```{r}
onlyFALSE%>%count(category)
```


```{r}

  ikea%>%
  filter(sellable_online=="FALSE")%>%count(old_price)  

```
```{r}
onlyTRUE<-
 ikea%>%
  filter(sellable_online=="TRUE")
```

```{r}
ikea%>%
  mutate(rating_discount= as.factor(
    case_when(discount >= 20 ~"Dissatisfied",
              discount >=10 ~"Considerable",
    discount<10 ~ "Acceptable",
    discount>=30~"Unacceptable"
    
 
     )
  )
  )
```
```{r}
ikea%>%count(rating_discount)

```
```{r}
ikea %>%
  add_count(rating_discount) %>% arrange(desc(n))%>%
  mutate(rating_discount_fct = fct_reorder(rating_discount, n)) %>%
  ggplot(aes(x = rating_discount_fct)) +
  geom_bar() +
  geom_text(aes(label = n, y = n), nudge_y = 40)+
  coord_flip() +
  theme_minimal() +
  labs(x = "Level of Rating",
       y = "Number",
       title ="Standard")

```

```{r}
Designer<- ikea%>%select(category,rating_discount)

```
```{r}
Huy<- Designer%>%select(category,rating_discount)%>%filter(rating_discount %in% c("Dissatisfied"))%>%count(category)%>% arrange(desc(n))
```
```{r}
Huy %>%
  add_count(category) %>% arrange(desc(n))%>%
  mutate(category_fct = fct_reorder(category, n)) %>%
  ggplot(aes(x = category_fct)) +
  geom_bar() +
  geom_text(aes(label = n, y = n), nudge_y = 30)+
  coord_flip() +
  theme_gray() +
  labs(x = "Category",
       y = "Number",
       title ="Dissatisfied items")

```
```{r}
##The items that have discount price/ total number of items, The percentage can show that our business runs well or not, regression modal. 


```
```{r}
##The most expensive furniture on average is ???? with an average price of $???
ikea <- ikea%>%
  group_by(category)%>%
  mutate(average_price = mean(price))%>%
  ungroup()

ikea%>%
  select(sellable_online,category,average_price)


ikea%>%gather(category,"Bar furniture","average_price",1:2)
  


##are they sellable online and most of them have other color option?
ikea <- ikea%>%
  group_by(sellable_online)%>%
  mutate(colours_available = (other_colors))


ikea%>%
  count(colours_available)
```
```{r}
ikea<-ikea%>%
  mutate(Totalsize= height*width*depth)%>% na.omit(height,width,depth)


    
  
``` 
```{r}
ikea %>%
  ggplot(aes(x=average_price, y=category)) + 
  geom_bar(stat="identity", fill="red") + 
  labs(title="Average Price by each category", 
       subtitle="Ikea") + 
  theme()
```

```{r}
## create a new variable for discount = Old price - Price
ikea<-ikea%>%
  mutate(discount=100-price/old_price*100)

```
```{r}
ikea%>%
sapply(.,class)
```
```{r}
ikea %>% 
  lm(discount ~ Totalsize, data = .) %>%
  summary()

```



